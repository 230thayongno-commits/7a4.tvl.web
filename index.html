<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>7A4 GALAXY COMMAND</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
        /* --- CORE VARIABLES --- */
        :root {
            /* GALAXY THEME (DEFAULT) */
            --primary: #00f3ff;
            --secondary: #bc13fe;
            --accent: #ff0055;
            --success: #00ff9d;
            --dark-bg: #030712;
            --card-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-color: #fff;
            --bg-gradient-1: radial-gradient(circle at 20% 30%, rgba(0, 243, 255, 0.05) 0%, transparent 50%);
            --bg-gradient-2: radial-gradient(circle at 80% 70%, rgba(188, 19, 254, 0.05) 0%, transparent 50%);
        }

        /* TET THEME OVERRIDE */
        body.tet-theme {
            --primary: #ffd700; /* V√†ng */
            --secondary: #ff0000; /* ƒê·ªè t∆∞∆°i */
            --accent: #ff4d4d; /* ƒê·ªè nh·∫°t h∆°n cho ƒëi·ªÉm nh·∫•n */
            --success: #32cd32; /* Xanh l√° */
            --dark-bg: #3e0000; /* ƒê·ªè ƒë·∫≠m n·ªÅn */
            --card-bg: rgba(255, 215, 0, 0.1); /* N·ªÅn th·∫ª v√†ng nh·∫°t */
            --glass-border: rgba(255, 215, 0, 0.3); /* Vi·ªÅn v√†ng */
            --text-color: #fffaf0;
            --bg-gradient-1: radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.15) 0%, transparent 60%);
            --bg-gradient-2: none;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--dark-bg);
            color: var(--text-color);
            margin: 0;
            min-height: 100vh;
            overflow-x: hidden;
            background-image: var(--bg-gradient-1), var(--bg-gradient-2);
            transition: background 0.5s ease;
        }

        /* Tet decoration background */
        body.tet-theme::before {
            content: "";
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: url('data:image/svg+xml;utf8,<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M20 0L25 15L40 20L25 25L20 40L15 25L0 20L15 15Z" fill="rgba(255,215,0,0.05)"/></svg>');
            pointer-events: none;
            z-index: -1;
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes floating { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideDownToast { from { top: -50px; opacity: 0; } to { top: 20px; opacity: 1; } }

        /* Firework Particles */
        .firework-particle {
            position: fixed;
            width: 6px; height: 6px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 99999;
            animation: fireworkPop 1s ease-out forwards;
        }
        @keyframes fireworkPop {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }

        .animate-in { animation: fadeIn 0.5s ease forwards; }
        .slide-in { animation: slideIn 0.3s ease-out forwards; }

        /* UI Components */
        /* Updated Toast Style (Notification) */
        #game-toast, #app-toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95); color: #000;
            padding: 12px 25px; border-radius: 50px;
            font-weight: 800; z-index: 20000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none; width: max-content; max-width: 90%;
            text-align: center; border: 2px solid transparent;
        }
        #game-toast.success { background: #e6fffa; color: #00a152; border-color: #00ff9d; }
        #game-toast.error { background: #ffe6e6; color: #d32f2f; border-color: #ff0055; }
        #game-toast.info { background: #f0f0f0; color: #555; border-color: #aaa; }

        /* Selector Screen */
        #selector-screen {
            position: fixed; inset: 0; background: var(--dark-bg);
            z-index: 9999; display: flex; flex-direction: column;
            justify-content: center; align-items: center; padding: 20px;
            text-align: center;
        }

        .hero-title {
            font-size: clamp(2rem, 8vw, 3.5rem); font-weight: 900;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text; color: transparent;
            margin-bottom: 10px; letter-spacing: -1px;
        }

        .team-grid {
            display: grid; grid-template-columns: repeat(2, 1fr);
            gap: 15px; width: 100%; max-width: 500px; margin-top: 40px;
        }

        .team-card {
            background: var(--card-bg); border: 1px solid var(--glass-border);
            padding: 30px 10px; border-radius: 20px; font-weight: 800;
            cursor: pointer; transition: 0.3s; text-transform: uppercase;
        }
        .team-card:hover { background: rgba(255,255,255,0.1); transform: scale(1.05); border-color: var(--primary); }

        /* App Layout */
        header {
            padding: 15px 20px; display: flex; justify-content: space-between;
            align-items: center; 
            background: rgba(0,0,0,0.3); backdrop-filter: blur(10px);
            position: sticky; top: 0; z-index: 100;
            border-bottom: 1px solid var(--glass-border);
        }

        .container { max-width: 1000px; margin: 0 auto; padding: 20px; padding-bottom: 100px; }

        .rank-card {
            background: var(--card-bg); border-radius: 24px; padding: 25px;
            margin-bottom: 20px; border: 1px solid var(--glass-border);
            position: relative;
        }

        .rank-item { margin-bottom: 15px; }
        .rank-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: 700; font-size: 0.9rem; }
        .bar-outer { background: rgba(255,255,255,0.05); height: 14px; border-radius: 10px; overflow: hidden; }
        .bar-inner { height: 100%; border-radius: 10px; transition: width 1s cubic-bezier(0.34, 1.56, 0.64, 1); }

        .reset-notice {
            text-align: center; font-size: 0.75rem; color: #aaa; margin-top: 15px; font-weight: 600;
            border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 10px;
        }

        .tiktok-group { display: flex; gap: 12px; margin-bottom: 30px; }
        .tiktok-link {
            flex: 1; display: flex; align-items: center; justify-content: center;
            gap: 10px; background: #000; padding: 15px; border-radius: 16px;
            text-decoration: none; color: #fff; font-weight: 800; font-size: 0.85rem;
            border: 1px solid var(--glass-border); transition: 0.3s;
        }
        .tiktok-link:hover { transform: translateY(-3px); border-color: var(--primary); }

        .mission-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .mission-card {
            background: var(--card-bg); padding: 30px; border-radius: 24px;
            border: 1px solid var(--glass-border); cursor: pointer;
            transition: 0.3s; position: relative; overflow: hidden;
            animation: floating 4s ease-in-out infinite;
        }
        .mission-card:hover { background: rgba(255,255,255,0.08); border-color: var(--primary); }
        .mission-card.locked { opacity: 0.5; cursor: not-allowed; animation: none; }

        .mission-icon { font-size: 3rem; margin-bottom: 15px; display: block; }
        .mission-name { font-size: 1.4rem; font-weight: 900; margin-bottom: 8px; color: var(--primary); }
        .mission-desc { font-size: 0.9rem; color: #aaa; line-height: 1.4; }

        .badge-soon {
            position: absolute; top: 12px; right: -30px; background: #febd23;
            color: #000; padding: 4px 35px; font-size: 0.65rem;
            font-weight: 900; transform: rotate(45deg);
        }

        /* Overlay Game */
        #game-overlay {
            position: fixed; inset: 0; background: var(--dark-bg);
            z-index: 1000; display: none; flex-direction: column; padding: 20px;
            overflow-y: auto;
        }

        /* NEW: In-Game Scoreboard */
        #game-scoreboard {
            display: flex; justify-content: center; gap: 10px;
            margin-bottom: 15px; padding: 10px;
            background: rgba(0,0,0,0.3); border-radius: 15px;
            flex-wrap: wrap;
        }
        .mini-score-card {
            display: flex; flex-direction: column; align-items: center;
            background: rgba(255,255,255,0.05); padding: 5px 10px;
            border-radius: 8px; min-width: 60px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .mini-score-name { font-size: 0.7rem; font-weight: 700; margin-bottom: 2px; }
        .mini-score-val { font-size: 0.9rem; font-weight: 900; color: #fff; }

        .game-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .game-content { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; max-width: 600px; margin: 0 auto; width: 100%; padding-bottom: 40px; }
        
        .q-tag { background: rgba(0, 243, 255, 0.1); color: var(--primary); padding: 5px 15px; border-radius: 20px; font-size: 0.75rem; font-weight: 800; margin-bottom: 15px; text-transform: uppercase; }
        .q-text { font-size: clamp(1.1rem, 4vw, 1.7rem); font-weight: 800; text-align: center; margin-bottom: 25px; line-height: 1.4; }

        .option-list { display: grid; gap: 14px; width: 100%; margin-bottom: 10px; }
        .option-item {
            background: var(--card-bg); border: 1px solid var(--glass-border);
            padding: 16px 20px; border-radius: 12px; color: var(--text-color);
            text-align: left; font-weight: 700; font-size: 0.95rem; cursor: pointer; transition: 0.2s;
        }
        .option-item:hover { background: rgba(255,255,255,0.1); border-color: var(--primary); }
        .option-item:disabled { opacity: 0.6; cursor: not-allowed; }

        .math-input {
            background: transparent; border: none; border-bottom: 4px solid var(--primary);
            color: var(--text-color); font-size: 3.5rem; width: 100%; text-align: center;
            font-weight: 900; outline: none; margin-bottom: 20px;
        }

        .btn-confirm {
            background: var(--primary); color: #000; width: 100%; padding: 15px 20px;
            border-radius: 12px; font-weight: 900; font-size: 1.0rem; margin-top: 10px; border: none; cursor: pointer;
        }
        .btn-confirm.small { width: auto; padding: 10px 14px; font-size: 0.9rem; border-radius: 10px; }
        .btn-confirm:disabled { background: #555; cursor: not-allowed; }

        footer {
            margin-top: 30px; padding: 30px; text-align: center;
            border-top: 1px solid var(--glass-border); color: #aaa; font-size: 0.8rem;
        }

        .hidden { display: none !important; }

        .update-card {
            background: rgba(255,255,255,0.03); border: 1px dashed rgba(255,255,255,0.06);
            padding: 12px 14px; border-radius: 12px; color: #ddd; font-weight: 700; margin-bottom: 18px;
        }

        /* --- NEW ADMIN PAGE --- */
        #admin-screen {
            display: none; position: fixed; inset: 0; background: var(--dark-bg);
            z-index: 2000; flex-direction: column; overflow-y: auto;
            padding: 20px;
        }
        .admin-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid var(--glass-border);
        }
        .admin-section {
            background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border);
            padding: 20px; border-radius: 16px; margin-bottom: 20px;
        }
        .admin-section h3 { margin-top: 0; color: var(--primary); font-size: 1rem; text-transform: uppercase; }
        .admin-input {
            width: 100%; padding: 12px; border-radius: 10px;
            border: 1px solid var(--glass-border); background: rgba(255,255,255,0.05);
            color: #fff; font-weight: 800; outline: none; margin-bottom: 15px;
        }

        /* --- SETTINGS MODAL --- */
        #settings-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
            z-index: 3000; display: none; justify-content: center; align-items: center;
        }
        .settings-content {
            background: #1a1a1a; padding: 25px; border-radius: 20px;
            width: 90%; max-width: 350px; border: 1px solid var(--glass-border);
        }
        .theme-option {
            display: flex; align-items: center; justify-content: space-between;
            padding: 15px; background: rgba(255,255,255,0.05);
            border-radius: 12px; margin-bottom: 10px; cursor: pointer; border: 1px solid transparent;
        }
        .theme-option.active { border-color: var(--primary); background: rgba(0, 243, 255, 0.1); }
        .theme-option:hover { background: rgba(255,255,255,0.1); }

        /* Header Buttons */
        .icon-btn {
            background: rgba(255,255,255,0.1); border: none; color: #fff;
            width: 36px; height: 36px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s; font-size: 1.2rem;
        }
        .icon-btn:hover { background: var(--primary); color: #000; }

        @media (max-width: 600px) {
            .mission-grid { grid-template-columns: 1fr; }
            .hero-title { font-size: 2.2rem; }
            .q-text { font-size: 1.2rem; }
            .option-item { padding: 12px 15px; font-size: 0.95rem; }
            .math-input { font-size: 2.4rem; }
            header { padding: 12px; }
            #user-info { gap: 8px !important; }
        }
    </style>
</head>
<body>

    <!-- NOTIFICATION TOASTS -->
    <div id="app-toast">Th√¥ng b√°o</div>
    <div id="game-toast">K·∫øt qu·∫£</div>

    <!-- SETTINGS MODAL -->
    <div id="settings-modal" onclick="if(event.target === this) galaxy.toggleSettings()">
        <div class="settings-content">
            <h3 style="margin-top:0; color:#fff; text-align:center;">C√ÄI ƒê·∫∂T</h3>
            <p style="font-size:0.8rem; color:#aaa; margin-bottom:15px;">Ch·ªçn giao di·ªán:</p>
            
            <div class="theme-option active" id="theme-galaxy" onclick="galaxy.setTheme('galaxy')">
                <span style="font-weight:700;">üåå Galaxy (M·∫∑c ƒë·ªãnh)</span>
                <span style="display:inline-block; width:15px; height:15px; background:#00f3ff; border-radius:50%;"></span>
            </div>
            
            <div class="theme-option" id="theme-tet" onclick="galaxy.setTheme('tet')">
                <span style="font-weight:700;">üßß T·∫øt Nguy√™n ƒê√°n</span>
                <div style="display:flex; gap:5px;">
                    <span style="display:inline-block; width:15px; height:15px; background:#ff0000; border-radius:50%;"></span>
                    <span style="display:inline-block; width:15px; height:15px; background:#ffd700; border-radius:50%;"></span>
                </div>
            </div>

            <button onclick="galaxy.toggleSettings()" class="btn-confirm" style="margin-top:15px; padding:12px;">ƒê√ìNG</button>
        </div>
    </div>

    <!-- M√ÄN H√åNH CH·ªåN T·ªî -->
    <div id="selector-screen">
        <div class="hero-title animate-in">7A4 GALAXY<br>COMMAND</div>
        <p class="animate-in" style="color: #aaa; letter-spacing: 2px; font-size: 0.75rem; font-weight: 600;">H·ªÜ TH·ªêNG √îN T·∫¨P HK2</p>
        
        <div class="team-grid animate-in" style="animation-delay: 0.2s;">
            <div class="team-card" onclick="galaxy.selectTeam('T·ªï 1')" style="color: #00f3ff">T·ªï 1</div>
            <div class="team-card" onclick="galaxy.selectTeam('T·ªï 2')" style="color: #bc13fe">T·ªï 2</div>
            <div class="team-card" onclick="galaxy.selectTeam('T·ªï 3')" style="color: #ff0055">T·ªï 3</div>
            <div class="team-card" onclick="galaxy.selectTeam('T·ªï 4')" style="color: #00ff9d">T·ªï 4</div>
        </div>

        <div style="margin-top: 30px; display:flex; gap:10px;">
             <button onclick="galaxy.toggleSettings()" class="icon-btn" style="width:auto; padding:0 20px; font-weight:700; font-size:0.9rem;">
                ‚öôÔ∏è C√†i ƒë·∫∑t
             </button>
        </div>
    </div>

    <!-- APP CH√çNH -->
    <div id="main-app" class="hidden">
        <header>
            <div style="font-weight: 900; letter-spacing: 1px; font-size: 1.1rem; display:flex; align-items:center; gap:10px;">
                7A4 COMMAND
            </div>
            <div id="user-info" style="display: flex; align-items: center; gap: 10px;">
                <span id="team-tag" style="font-weight: 900; background: var(--primary); color: #000; padding: 4px 12px; border-radius: 8px; font-size: 0.8rem;"></span>
                
                <button onclick="galaxy.toggleSettings()" class="icon-btn">‚öôÔ∏è</button>
                <button id="admin-entry-btn" onclick="galaxy.openAdminPage()" class="icon-btn">üëë</button>
                <button onclick="galaxy.logout()" class="icon-btn" style="color:#ff5a5a;">üîÑ</button>
            </div>
        </header>

        <div class="container animate-in">
            <div class="rank-card">
                <h2 style="margin-top: 0; font-size: 1.1rem; text-align: center; color: var(--primary); text-transform: uppercase; letter-spacing: 2px;">ƒêi·ªÉm S·ªë Chi·∫øn ƒê·ªôi</h2>
                <div id="ranking-list"></div>
                <div id="prev-winner" style="margin-top:12px; font-weight:800; text-align:center; color:#ddd;"></div>
                <div class="reset-notice">
                    ‚è∞ H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông reset ƒëi·ªÉm v√†o m·ªói <strong>Ch·ªß nh·∫≠t 12:00</strong>.
                </div>
            </div>

            <div class="update-card">
                B·∫£n c·∫≠p nh·∫≠t 2.0 ‚Äî Giao di·ªán T·∫øt, th√¥ng b√°o m·ªõi, b·∫£ng ƒëi·ªÉm tr·ª±c ti·∫øp trong game & trang Admin ri√™ng bi·ªát!
            </div>

            <div class="tiktok-group">
                <a href="https://www.tiktok.com/@7a4.tvl.2025.2026" target="_blank" class="tiktok-link">TikTok A4 1</a>
                <a href="https://www.tiktok.com/@a4.tvl.2025.2026" target="_blank" class="tiktok-link">TikTok A4 2</a>
            </div>

            <div class="mission-grid">
                <div class="mission-card" onclick="englishGame.start()">
                    <span class="mission-icon">üá¨üáß</span>
                    <div class="mission-name">Ti·∫øng Anh HK2</div>
                    <div class="mission-desc">100+ c√¢u h·ªèi Vocabulary, Adverbs, How structure, Ability...</div>
                </div>

                <div class="mission-card" onclick="mathGame.start()">
                    <span class="mission-icon">üìê</span>
                    <div class="mission-name">To√°n H·ªçc</div>
                    <div class="mission-desc">C·ªông tr·ª´, nh√¢n chia, t√¨m x, s·ªë m≈©.</div>
                </div>

                <div class="mission-card locked">
                    <span class="badge-soon">S·∫ÆP C√ì</span>
                    <span class="mission-icon">üß™</span>
                    <div class="mission-name">KHTN</div>
                    <div class="mission-desc">H·ªá th·ªëng c√¢u h·ªèi √¥n t·∫≠p Khoa h·ªçc t·ª± nhi√™n.</div>
                </div>
            </div>

            <footer>
                *N·∫øu web c√≥ l·ªói g√¨ hay c√°c c√¢u h·ªèi sai xin li√™n h·ªá admin t·∫°i 2 trang tik tok c·ªßa l·ªõp.
            </footer>
        </div>
    </div>

    <!-- TRANG ADMIN RI√äNG BI·ªÜT -->
    <div id="admin-screen">
        <div class="admin-header">
            <h2 class="hero-title" style="font-size:1.8rem; margin:0;">ADMIN CONTROL</h2>
            <button onclick="galaxy.closeAdminPage()" class="btn-confirm small" style="background:#444; color:#fff;">QUAY L·∫†I</button>
        </div>

        <div id="admin-login-area">
            <p style="text-align:center; margin-bottom:20px;">Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ truy c·∫≠p quy·ªÅn qu·∫£n tr·ªã.</p>
            <input type="password" id="admin-password-input" class="admin-input" placeholder="Nh·∫≠p m·∫≠t kh·∫©u..." style="text-align:center;">
            <button onclick="galaxy.checkAdminLogin()" class="btn-confirm">ƒêƒÇNG NH·∫¨P</button>
        </div>

        <div id="admin-controls-area" class="hidden">
            <div class="admin-section">
                <h3>Th√™m/Tr·ª´ ƒêi·ªÉm Th·ªß C√¥ng</h3>
                <input id="admin-point-input" type="number" class="admin-input" placeholder="Nh·∫≠p s·ªë ƒëi·ªÉm (VD: 10 ho·∫∑c -5)" />
                
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <button onclick="adminApplyInput('to1')" class="btn-confirm small">√ÅP D·ª§NG T·ªî 1</button>
                    <button onclick="adminApplyInput('to2')" class="btn-confirm small">√ÅP D·ª§NG T·ªî 2</button>
                    <button onclick="adminApplyInput('to3')" class="btn-confirm small">√ÅP D·ª§NG T·ªî 3</button>
                    <button onclick="adminApplyInput('to4')" class="btn-confirm small">√ÅP D·ª§NG T·ªî 4</button>
                </div>
            </div>

            <div class="admin-section">
                <h3>ƒêi·ªÅu Ch·ªânh Nhanh (+/- 1)</h3>
                <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:10px; text-align:center;">
                    <div>
                        <div style="margin-bottom:5px; color:#00f3ff">T·ªï 1</div>
                        <button onclick="adminAdjust('to1',1)" class="btn-confirm small" style="margin-bottom:5px;">+1</button>
                        <button onclick="adminAdjust('to1',-1)" class="btn-confirm small">-1</button>
                    </div>
                    <div>
                        <div style="margin-bottom:5px; color:#bc13fe">T·ªï 2</div>
                        <button onclick="adminAdjust('to2',1)" class="btn-confirm small" style="margin-bottom:5px;">+1</button>
                        <button onclick="adminAdjust('to2',-1)" class="btn-confirm small">-1</button>
                    </div>
                    <div>
                        <div style="margin-bottom:5px; color:#ff0055">T·ªï 3</div>
                        <button onclick="adminAdjust('to3',1)" class="btn-confirm small" style="margin-bottom:5px;">+1</button>
                        <button onclick="adminAdjust('to3',-1)" class="btn-confirm small">-1</button>
                    </div>
                    <div>
                        <div style="margin-bottom:5px; color:#00ff9d">T·ªï 4</div>
                        <button onclick="adminAdjust('to4',1)" class="btn-confirm small" style="margin-bottom:5px;">+1</button>
                        <button onclick="adminAdjust('to4',-1)" class="btn-confirm small">-1</button>
                    </div>
                </div>
            </div>

            <div class="admin-section" style="border-color:#ff5a5a;">
                <h3 style="color:#ff5a5a;">V√πng Nguy Hi·ªÉm</h3>
                <div style="display:flex; gap:10px;">
                    <button onclick="adminResetScores()" class="btn-confirm" style="background:#febd23; color:#000;">RESET TO√ÄN B·ªò ƒêI·ªÇM</button>
                    <button onclick="adminUndo()" class="btn-confirm" style="background:#888; color:#fff;">HO√ÄN T√ÅC (UNDO)</button>
                </div>
            </div>

             <button onclick="galaxy.logoutAdmin()" style="width:100%; padding:15px; background:transparent; border:1px solid #ff5a5a; color:#ff5a5a; border-radius:12px; font-weight:bold; cursor:pointer;">ƒêƒÇNG XU·∫§T ADMIN</button>
        </div>
    </div>

    <!-- GAME OVERLAY -->
    <div id="game-overlay">
        <!-- NEW: LIVE SCOREBOARD -->
        <div id="game-scoreboard">
            <!-- Will be filled by JS -->
        </div>

        <div class="game-nav">
            <div id="game-label" style="font-weight: 900; color: var(--primary); letter-spacing: 2px;">MISSION</div>
            <button onclick="galaxy.closeGame()" style="background:none; border:none; color:#fff; font-size: 1.5rem; cursor:pointer;">‚úï</button>
        </div>
        <div id="game-content-area" class="game-content">
            <div id="q-tag" class="q-tag">Ki·∫øn th·ª©c HK2</div>
            <div id="q-text" class="q-text">ƒêang t·∫£i c√¢u h·ªèi...</div>
            <div id="q-action" style="width: 100%;"></div>
            
            <!-- Removed old q-feedback text div -->
        </div>
    </div>

<script type="module">
  /***** Firebase setup *****/
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import {
    getFirestore, doc, getDoc, setDoc, updateDoc, onSnapshot, collection, getDocs,
    writeBatch, increment
  } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBtdoU4bzBVsXXvYswbUf0smAuYIq9rxlM",
    authDomain: "a4-galaxy-command.firebaseapp.com",
    projectId: "a4-galaxy-command",
    storageBucket: "a4-galaxy-command.firebasestorage.app",
    messagingSenderId: "147400399283",
    appId: "1:147400399283:web:6d470d3e02a94e01f053c6",
    measurementId: "G-678SMH2ND5"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const ADMIN_PASSWORD = "emyeudang"; 

  const DOC_TO_TEAM = {
    to1: { id: "T·ªï 1", color: "#00f3ff" },
    to2: { id: "T·ªï 2", color: "#bc13fe" },
    to3: { id: "T·ªï 3", color: "#ff0055" },
    to4: { id: "T·ªï 4", color: "#00ff9d" }
  };

  const TEAMS = [
    { id: "T·ªï 1", color: "#00f3ff" },
    { id: "T·ªï 2", color: "#bc13fe" },
    { id: "T·ªï 3", color: "#ff0055" },
    { id: "T·ªï 4", color: "#00ff9d" }
  ];

  let realtimeTeams = {};
  let adminLogged = false;
  let adminLastAction = null;

  const galaxy = {
    team: null,
    currentTheme: 'galaxy',

    init: async function() {
      // Theme Init
      const savedTheme = localStorage.getItem('7a4_theme') || 'galaxy';
      this.setTheme(savedTheme);

      // Firework listener
      document.body.addEventListener('click', (e) => {
        if(this.currentTheme === 'tet') {
            this.spawnFirework(e.clientX, e.clientY);
        }
      });

      this.setupRealtimeListeners();
      await this.checkWeeklyResetFirestore();

      const saved = localStorage.getItem('7a4_member');
      if (saved) {
        this.team = saved;
        this.showMain();
      } else {
        this.showSelector();
      }

      this.renderRank();

      window.addEventListener('storage', (e) => {
        if (!e.key) return;
        if (e.key.startsWith('score_') || e.key === '7a4_last_reset' || e.key === '7a4_prev_winners') {
          this.renderRank();
        }
      });
    },

    // --- THEME FUNCTIONS ---
    setTheme(themeName) {
        this.currentTheme = themeName;
        localStorage.setItem('7a4_theme', themeName);
        
        if (themeName === 'tet') {
            document.body.classList.add('tet-theme');
            document.getElementById('theme-galaxy').classList.remove('active');
            document.getElementById('theme-tet').classList.add('active');
        } else {
            document.body.classList.remove('tet-theme');
            document.getElementById('theme-galaxy').classList.add('active');
            document.getElementById('theme-tet').classList.remove('active');
        }
    },

    toggleSettings() {
        const el = document.getElementById('settings-modal');
        if(el.style.display === 'flex') el.style.display = 'none';
        else el.style.display = 'flex';
    },

    spawnFirework(x, y) {
        const colors = ['#ff0000', '#ffd700', '#ff0055', '#ffffff'];
        for(let i=0; i<10; i++) {
            const p = document.createElement('div');
            p.className = 'firework-particle';
            p.style.left = x + 'px';
            p.style.top = y + 'px';
            p.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
            
            // Random direction
            const angle = Math.random() * Math.PI * 2;
            const velocity = 20 + Math.random() * 50;
            const tx = Math.cos(angle) * velocity;
            const ty = Math.sin(angle) * velocity;
            
            p.style.setProperty('--tx', `${tx}px`);
            p.style.setProperty('--ty', `${ty}px`);
            
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 1000);
        }
    },
    // -----------------------

    selectTeam(name) {
      this.team = name;
      localStorage.setItem('7a4_member', name);
      this.showMain();
    },

    showSelector() {
      document.getElementById('selector-screen').style.display = 'flex';
      document.getElementById('main-app').classList.add('hidden');
      document.getElementById('main-app').style.display = 'none';
    },

    showMain() {
      document.getElementById('selector-screen').style.display = 'none';
      document.getElementById('main-app').classList.remove('hidden');
      document.getElementById('main-app').style.display = 'block';
      document.getElementById('team-tag').innerText = this.team;
      
      const t = TEAMS.find(t => t.id === this.team);
      if(t) {
        document.getElementById('team-tag').style.background = t.color;
      }
      this.renderRank();
    },

    logout() {
      localStorage.removeItem('7a4_member');
      this.team = null;
      this.showSelector();
    },

    teamToDocId(teamLabel) {
      if (!teamLabel) return null;
      const num = teamLabel.replace(/\D/g,'');
      return 'to' + num;
    },

    async addPoints(p) {
      if (!this.team) return;
      const docId = this.teamToDocId(this.team);
      if (!docId) return;

      const ref = doc(db, "teams", docId);
      try {
        const s = await getDoc(ref);
        if (!s.exists()) {
          await setDoc(ref, {
            name: DOC_TO_TEAM[docId].id,
            score: 0,
            updatedAt: Date.now()
          });
        }
        await updateDoc(ref, {
          score: increment(p),
          updatedAt: Date.now()
        });
      } catch (e) {
        console.error("addPoints error:", e);
      }
    },

    async ensureTeamsDocs() {
      for (const docId of Object.keys(DOC_TO_TEAM)) {
        const ref = doc(db, "teams", docId);
        const s = await getDoc(ref);
        if (!s.exists()) {
          await setDoc(ref, { name: DOC_TO_TEAM[docId].id, score: 0, updatedAt: Date.now() });
        }
      }
    },

    // --- ADMIN PAGE LOGIC ---
    openAdminPage() {
        document.getElementById('main-app').style.display = 'none';
        document.getElementById('admin-screen').style.display = 'flex';
        
        if (adminLogged) {
            document.getElementById('admin-login-area').style.display = 'none';
            document.getElementById('admin-controls-area').classList.remove('hidden');
            document.getElementById('admin-controls-area').style.display = 'block';
        } else {
            document.getElementById('admin-login-area').style.display = 'block';
            document.getElementById('admin-controls-area').classList.add('hidden');
            document.getElementById('admin-controls-area').style.display = 'none';
        }
    },

    closeAdminPage() {
        document.getElementById('admin-screen').style.display = 'none';
        if (this.team) {
            document.getElementById('main-app').style.display = 'block';
        } else {
            document.getElementById('selector-screen').style.display = 'flex';
        }
    },

    checkAdminLogin() {
        const input = document.getElementById('admin-password-input');
        if (input.value === ADMIN_PASSWORD) {
            adminLogged = true;
            input.value = "";
            this.toast("ƒêƒÉng nh·∫≠p Admin th√†nh c√¥ng!");
            this.openAdminPage(); // Refresh view
        } else {
            alert("M·∫≠t kh·∫©u sai");
        }
    },
    
    logoutAdmin() {
        adminLogged = false;
        this.toast("ƒê√£ ƒëƒÉng xu·∫•t Admin");
        this.closeAdminPage();
    },

    async adminAdjustPoints(docId, delta) {
      if (!adminLogged) return;
      const ref = doc(db, "teams", docId);
      try {
        const s = await getDoc(ref);
        if (!s.exists()) {
          await setDoc(ref, { name: DOC_TO_TEAM[docId].id, score: 0, updatedAt: Date.now() });
        }
        await updateDoc(ref, { score: increment(delta), updatedAt: Date.now() });

        adminLastAction = { type: "adjust", docId, delta };
        this.toast(`${delta>0? '+'+delta: delta} ƒëi·ªÉm (Admin)`);
      } catch (e) {
        console.error(e);
        this.toast("L·ªói Admin update");
      }
    },
    // ------------------------

    toast(m) {
      const t = document.getElementById('app-toast');
      t.innerText = m;
      t.style.display = 'block';
      t.style.animation = 'slideDownToast 0.3s forwards';
      setTimeout(() => { t.style.display = 'none'; }, 2000);
    },

    showGameToast(msg, type) {
        const t = document.getElementById('game-toast');
        t.innerText = msg;
        t.className = type; // success, error, info
        t.style.display = 'block';
        t.style.animation = 'slideDownToast 0.3s forwards';
        
        // Hide after some time
        setTimeout(() => { 
            t.style.display = 'none'; 
        }, type === 'error' ? 2000 : 1500);
    },

    renderRank() {
      const list = document.getElementById('ranking-list');
      
      let data = [];
      if (Object.keys(realtimeTeams).length) {
        data = Object.keys(DOC_TO_TEAM).map(docId => ({
          id: DOC_TO_TEAM[docId].id,
          score: realtimeTeams[docId]?.score ?? 0,
          color: DOC_TO_TEAM[docId].color
        }));
      } else {
        // Fallback or init
        data = TEAMS.map(t => ({...t, score: 0}));
      }

      data = data.sort((a,b) => b.score - a.score);
      const max = Math.max(...data.map(d => d.score), 10);

      list.innerHTML = data.map(d => `
        <div class="rank-item">
          <div class="rank-label"><span style="color:${d.color}">${d.id}</span><span>${d.score} XP</span></div>
          <div class="bar-outer"><div class="bar-inner" style="width:${(d.score/max)*100}%; background:${d.color}"></div></div>
        </div>
      `).join('');

      this.renderPrevWinner();
      this.renderGameScoreboard(); // Also update in-game board
    },

    // NEW: In-Game Scoreboard Render
    renderGameScoreboard() {
        const board = document.getElementById('game-scoreboard');
        if (!board) return;

        let data = [];
        if (Object.keys(realtimeTeams).length) {
            data = Object.keys(DOC_TO_TEAM).map(docId => ({
                id: DOC_TO_TEAM[docId].id,
                score: realtimeTeams[docId]?.score ?? 0,
                color: DOC_TO_TEAM[docId].color
            }));
        } else {
            data = TEAMS.map(t => ({...t, score: 0}));
        }

        // Simple sort by ID or Score? Let's keep fixed order (T1-T4) for stability or Sorted
        // Let's sort by ID to keep position fixed (easier to read while playing)
        data.sort((a,b) => a.id.localeCompare(b.id));

        board.innerHTML = data.map(d => `
            <div class="mini-score-card">
                <span class="mini-score-name" style="color:${d.color}">${d.id}</span>
                <span class="mini-score-val">${d.score}</span>
            </div>
        `).join('');
    },

    async renderPrevWinner() {
      const prevEl = document.getElementById('prev-winner');
      try {
        const metaRef = doc(db, "meta", "weekly");
        const snap = await getDoc(metaRef);
        if (snap.exists()) {
          const data = snap.data();
          if (data && Array.isArray(data.winners) && data.winners.length) {
            if (data.winners.length === 1) {
              prevEl.innerText = `üèÜ V√¥ ƒë·ªãch tu·∫ßn tr∆∞·ªõc: ${data.winners[0]} ‚Äî ${data.maxScore} XP`;
            } else {
              prevEl.innerText = `ü§ù H√≤a tu·∫ßn tr∆∞·ªõc: ${data.winners.join(', ')} ‚Äî ${data.maxScore} XP`;
            }
            return;
          }
        }
      } catch(e) { console.warn(e); }
      prevEl.innerText = '';
    },

    closeGame() {
      document.getElementById('game-overlay').style.display = 'none';
      document.getElementById('game-toast').style.display = 'none';
    },

    applyTransition() {
      const content = document.getElementById('game-content-area');
      content.classList.remove('slide-in');
      void content.offsetWidth; 
      content.classList.add('slide-in');
    },

    async checkWeeklyResetFirestore() {
      try {
        await this.ensureTeamsDocs();
        const now = new Date();
        const reset = new Date(now);
        const day = reset.getDay(); 
        reset.setDate(now.getDate() - day);
        reset.setHours(12,0,0,0);

        if (now.getDay() === 0 && now.getHours() < 12) reset.setDate(reset.getDate() - 7);
        if (reset.getTime() > now.getTime()) reset.setDate(reset.getDate() - 7);

        const resetTime = reset.getTime();
        const metaRef = doc(db, "meta", "weekly");
        const metaSnap = await getDoc(metaRef);
        const lastReset = metaSnap.exists() ? (metaSnap.data().lastReset || 0) : 0;

        if (!lastReset || lastReset < resetTime) {
          const colSnap = await getDocs(collection(db, "teams"));
          const prevScores = {};
          colSnap.forEach(d => prevScores[d.id] = d.data().score || 0);

          const arr = Object.entries(prevScores);
          const maxScore = arr.length ? Math.max(...arr.map(a=>a[1])) : 0;
          const winners = arr.filter(a=>a[1]===maxScore).map(a=> DOC_TO_TEAM[a[0]]?.id ?? a[0]);

          const batch = writeBatch(db);
          colSnap.forEach(d => batch.update(doc(db, "teams", d.id), { score: 0, updatedAt: Date.now() }));

          batch.set(metaRef, {
            lastReset: resetTime,
            prevScores,
            winners,
            maxScore,
            updatedAt: Date.now()
          }, { merge: true });

          await batch.commit();
        }
      } catch (e) { console.error(e); }
    },

    setupRealtimeListeners() {
      try {
        onSnapshot(collection(db, "teams"), (snapshot) => {
          const tmp = {};
          snapshot.forEach(d => tmp[d.id] = d.data());
          realtimeTeams = tmp;
          this.renderRank();
        });

        onSnapshot(doc(db, "meta", "weekly"), () => {
          this.renderPrevWinner();
        });
      } catch (e) { console.error(e); }
    }
  };

  function adminAdjust(docId, delta) {
    galaxy.adminAdjustPoints(docId, delta);
  }

  async function adminApplyInput(docId){
    if (!adminLogged) return;
    const input = document.getElementById("admin-point-input");
    const val = parseInt((input?.value || "").trim(), 10);
    if (!input || isNaN(val) || val === 0) {
      galaxy.toast("Nh·∫≠p s·ªë ƒëi·ªÉm h·ª£p l·ªá");
      return;
    }
    await galaxy.adminAdjustPoints(docId, val);
    input.value = "";
  }

  async function adminResetScores(){
    if (!adminLogged) return;
    if(!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën RESET ƒëi·ªÉm v·ªÅ 0?")) return;
    try{
      await galaxy.ensureTeamsDocs();
      const colSnap = await getDocs(collection(db, "teams"));
      const before = {};
      colSnap.forEach(d => before[d.id] = d.data().score || 0);

      const batch = writeBatch(db);
      colSnap.forEach(d => batch.update(doc(db, "teams", d.id), { score: 0, updatedAt: Date.now() }));
      await batch.commit();

      adminLastAction = { type: "reset", before };
      galaxy.toast("ƒê√£ RESET ƒëi·ªÉm t·∫•t c·∫£ t·ªï");
    }catch(e){
      console.error(e);
      galaxy.toast("L·ªói reset ƒëi·ªÉm");
    }
  }

  async function adminUndo(){
    if (!adminLogged || !adminLastAction){
      galaxy.toast("Kh√¥ng c√≥ g√¨ ƒë·ªÉ ho√†n t√°c");
      return;
    }
    try{
      if (adminLastAction.type === "adjust"){
        const { docId, delta } = adminLastAction;
        await galaxy.adminAdjustPoints(docId, -delta);
        adminLastAction = null;
        galaxy.toast("ƒê√£ ho√†n t√°c");
        return;
      }
      if (adminLastAction.type === "reset"){
        const before = adminLastAction.before || {};
        const batch = writeBatch(db);
        for (const docId of Object.keys(DOC_TO_TEAM)){
          const ref = doc(db, "teams", docId);
          const score = before[docId] ?? 0;
          batch.update(ref, { score, updatedAt: Date.now() });
        }
        await batch.commit();
        adminLastAction = null;
        galaxy.toast("ƒê√£ ho√†n t√°c RESET");
        return;
      }
    }catch(e){
      console.error(e);
      galaxy.toast("L·ªói ho√†n t√°c");
    }
  }

  const mathGame = {
    ans: 0,
    isProcessing: false,
    start() {
      document.getElementById('game-overlay').style.display = 'flex';
      document.getElementById('game-label').innerText = "MATH MISSION";
      galaxy.renderGameScoreboard();
      this.generate();
    },
    generate() {
      this.isProcessing = false;
      galaxy.applyTransition();
      const type = Math.floor(Math.random() * 4);
      let q = "";
      
      if (type === 0) {
        const a = Math.floor(Math.random() * 100), b = Math.floor(Math.random() * 50);
        this.ans = a + b; q = `${a} + ${b} = ?`;
      } else if (type === 1) {
        const a = Math.floor(Math.random() * 12) + 2, b = Math.floor(Math.random() * 11) + 2;
        this.ans = a * b; q = `${a} √ó ${b} = ?`;
      } else if (type === 2) {
        const x = Math.floor(Math.random() * 30), a = Math.floor(Math.random() * 20);
        this.ans = x; q = `T√¨m x: x + ${a} = ${x + a}`;
      } else {
        const b = Math.floor(Math.random() * 5) + 2, p = Math.floor(Math.random() * 2) + 2;
        this.ans = Math.pow(b, p); q = `${b}<sup>${p}</sup> = ?`;
      }
      document.getElementById('q-text').innerHTML = q;
      document.getElementById('q-action').innerHTML = `
        <input type="number" id="m-input" class="math-input" autofocus>
        <div style="display:flex; gap:10px; margin-top:6px;">
          <button id="btn-m-confirm" class="btn-confirm" onclick="mathGame.check()">X√ÅC NH·∫¨N</button>
          <button class="btn-confirm small" style="background:#555;" onclick="mathGame.skip()">B·ªé QUA</button>
        </div>
      `;
      const input = document.getElementById('m-input');
      if (input) input.focus();
    },
    check() {
      if (this.isProcessing) return;
      this.isProcessing = true;
      const btn = document.getElementById('btn-m-confirm');
      if (btn) btn.disabled = true;

      const val = parseInt(document.getElementById('m-input').value || '', 10);
      if (val === this.ans) {
        galaxy.showGameToast("ƒê√öNG R·ªíI! +5 XP", "success");
        galaxy.addPoints(5);
        setTimeout(() => this.generate(), 800);
      } else {
        galaxy.showGameToast(`SAI R·ªíI!`, "error");
        setTimeout(() => this.generate(), 1500);
      }
    },
    skip() {
      if (this.isProcessing) return;
      this.isProcessing = true;
      galaxy.showGameToast("ƒê√É B·ªé QUA", "info");
      setTimeout(() => { this.isProcessing = false; this.generate(); }, 600);
    }
  };

  /* GI·ªÆ NGUY√äN ENGLISH_BANK KH√îNG THAY ƒê·ªîI */
const ENGLISH_BANK = [
  // --- TOPIC: ADJECTIVES VS ADVERBS ---
  { q: "She is a very ________ designer. She always has new ideas.", a: "creative", o: ["creative", "creatively", "creation"], t: "Adj_Adv" },
  { q: "He decorated the room ________ for the party.", a: "creatively", o: ["creative", "creatively", "create"], t: "Adj_Adv" },
  { q: "You should be ________ when speaking to elderly people.", a: "polite", o: ["polite", "politely", "politeness"], t: "Adj_Adv" },
  { q: "The boy replied ________ to the teacher and got into trouble.", a: "rudely", o: ["rude", "rudely", "rudeness"], t: "Adj_Adv" },
  { q: "It was ________ of him to ignore my question.", a: "rude", o: ["rude", "rudely", "rudest"], t: "Adj_Adv" },
  { q: "This sofa is very ________. I can sleep on it.", a: "comfortable", o: ["comfortable", "comfortably", "comfort"], t: "Adj_Adv" },
  { q: "We sat ________ by the fire and drank hot cocoa.", a: "comfortably", o: ["comfortable", "comfortably", "comforting"], t: "Adj_Adv" },
  { q: "She speaks English very ________.", a: "well", o: ["good", "well", "goodness"], t: "Adj_Adv" },
  { q: "He is a ________ student. He always gets high marks.", a: "good", o: ["well", "good", "badly"], t: "Adj_Adv" },
  { q: "The team played ________ yesterday and lost the match.", a: "badly", o: ["bad", "badly", "worse"], t: "Adj_Adv" },
  { q: "The weather is really ________ today.", a: "bad", o: ["badly", "bad", "worse"], t: "Adj_Adv" },
  { q: "The test was surprisingly ________.", a: "easy", o: ["easy", "easily", "ease"], t: "Adj_Adv" },
  { q: "She passed the exam ________.", a: "easily", o: ["easy", "easily", "easier"], t: "Adj_Adv" },
  { q: "Please be ________! The baby is sleeping.", a: "quiet", o: ["quiet", "quietly", "quite"], t: "Adj_Adv" },
  { q: "The students worked ________ in the library.", a: "quietly", o: ["quiet", "quietly", "quietness"], t: "Adj_Adv" },
  { q: "He asked ________ for permission to leave.", a: "politely", o: ["polite", "politely", "politeness"], t: "Adj_Adv" },

  // --- TOPIC: VOCABULARY & WORD FORM ---
  { q: "That is an ________ painting. I've never seen anything like it.", a: "unusual", o: ["unusual", "usual", "usually"], t: "Vocabulary" },
  { q: "We need to measure the ________ of the triangle.", a: "angle", o: ["angel", "angle", "angry"], t: "Vocabulary" },
  { q: "My sister loves taking pictures. She wants to study ________.", a: "photography", o: ["photographer", "photography", "photograph"], t: "Vocabulary" },
  { q: "The ________ asked us to smile for the picture.", a: "photographer", o: ["photography", "photographer", "photographic"], t: "Vocabulary" },
  { q: "I have a terrible ________. I always forget names.", a: "memory", o: ["memorize", "memory", "memorable"], t: "Vocabulary" },
  { q: "Our trip to Paris was truly ________.", a: "memorable", o: ["memory", "memorize", "memorable"], t: "Vocabulary" },
  { q: "I need to ________ these vocabulary words for the test.", a: "memorize", o: ["memory", "memorize", "memorable"], t: "Vocabulary" },
  { q: "We watched the amazing ________ on New Year's Eve.", a: "firework display", o: ["firework display", "fire work", "display fire"], t: "Vocabulary" },
  { q: "When did they ________? - Last year.", a: "get married", o: ["get marry", "get married", "got marry"], t: "Vocabulary" },
  { q: "What time did you ________ for the party?", a: "arrive", o: ["arrive", "arriving", "arrival"], t: "Vocabulary" },

  // --- TOPIC: VERB PATTERNS (NEED TO / DECIDE TO) ---
  { q: "I need ________ my homework right now.", a: "to finish", o: ["finish", "to finish", "finishing"], t: "Grammar" },
  { q: "You need to ________ careful when crossing the street.", a: "be", o: ["be", "is", "being"], t: "Grammar" },
  { q: "She needs to ________ quiet in the hospital.", a: "be", o: ["do", "be", "make"], t: "Grammar" },
  { q: "They decided ________ to the beach for their holiday.", a: "to go", o: ["go", "to go", "going"], t: "Grammar" },
  { q: "He decided ________ a new car.", a: "to buy", o: ["buy", "to buy", "buying"], t: "Grammar" },
  { q: "Did you ________ permission before using my phone?", a: "ask for", o: ["ask with", "ask for", "ask to"], t: "Phrases" },
  { q: "I must ________ permission to leave early.", a: "ask for", o: ["ask", "ask for", "asking"], t: "Phrases" },

  // --- TOPIC: ACTION VERBS & PREPOSITIONS ---
  { q: "The cat tried to ________ the tall tree.", a: "climb up", o: ["climb up", "lie on", "sit on"], t: "Actions" },
  { q: "He was so happy he started to ________.", a: "jump up", o: ["jump up", "lie on", "walk on"], t: "Actions" },
  { q: "I like to ________ the sofa and watch TV.", a: "lie on", o: ["climb up", "lie on", "stand in"], t: "Actions" },
  { q: "Please ________ the queue and wait for your turn.", a: "stand in", o: ["stand in", "walk on", "sit on"], t: "Actions" },
  { q: "The baby learned to ________ the grass.", a: "walk on", o: ["walk on", "climb up", "stand in"], t: "Actions" },
  { q: "Come and ________ this chair next to me.", a: "sit on", o: ["sit on", "lie on", "climb up"], t: "Actions" },
  { q: "Don't ________ the wall, it's dangerous!", a: "climb up", o: ["walk on", "climb up", "stand in"], t: "Actions" },
  { q: "The floor is wet. Don't ________ it.", a: "walk on", o: ["walk on", "jump up", "lie on"], t: "Actions" },
  { q: "He likes to ________ the floor to play with his toys.", a: "sit on", o: ["sit on", "climb up", "stand in"], t: "Actions" },
  { q: "When the teacher entered, the students had to ________ their places.", a: "stand in", o: ["stand in", "jump up", "walk on"], t: "Actions" },

  // --- TOPIC: ABILITY (CAN/COULD/WILL BE ABLE TO) ---
  { q: "I ________ swim when I was five years old.", a: "could", o: ["can", "could", "will be able to"], t: "Ability" },
  { q: "She ________ speak three languages now.", a: "can", o: ["could", "can", "will be able to"], t: "Ability" },
  { q: "I ________ finish this project tomorrow.", a: "will be able to", o: ["could", "can", "will be able to"], t: "Ability" },
  { q: "Mozart ________ play music when he was very young.", a: "could", o: ["can", "could", "will be able to"], t: "Ability" },
  { q: "Sorry, I ________ help you right now. I'm busy.", a: "can't", o: ["couldn't", "can't", "won't be able to"], t: "Ability" },
  { q: "Yesterday, I ________ find my keys anywhere.", a: "couldn't", o: ["can't", "couldn't", "won't be able to"], t: "Ability" },
  { q: "In the future, robots ________ do all the housework.", a: "will be able to", o: ["can", "could", "will be able to"], t: "Ability" },
  { q: "________ you ride a bike when you were six?", a: "Could", o: ["Can", "Could", "Will"], t: "Ability" },
  { q: "I hope I ________ travel to Japan next year.", a: "will be able to", o: ["can", "could", "will be able to"], t: "Ability" },
  { q: "He ________ run very fast now, he is an athlete.", a: "can", o: ["could", "can", "will be able to"], t: "Ability" },
  { q: "The text was blurry, so I ________ read it.", a: "couldn't", o: ["can't", "couldn't", "won't be able to"], t: "Ability" },
  { q: "If you study hard, you ________ pass the exam.", a: "will be able to", o: ["can", "could", "will be able to"], t: "Ability" },

  // --- TOPIC: WH- QUESTIONS (HOW...) ---
  { q: "________ is it from your house to the school?", a: "How far", o: ["How long", "How far", "How much"], t: "Questions" },
  { q: "________ does this shirt cost?", a: "How much", o: ["How many", "How much", "How long"], t: "Questions" },
  { q: "________ students are there in your class?", a: "How many", o: ["How much", "How many", "How often"], t: "Questions" },
  { q: "________ do you go to the cinema? - Twice a month.", a: "How often", o: ["How long", "How often", "How far"], t: "Questions" },
  { q: "________ does the movie last? - Two hours.", a: "How long", o: ["How often", "How long", "How tall"], t: "Questions" },
  { q: "________ is your brother? - He is 1.7 meters.", a: "How tall", o: ["How high", "How tall", "How long"], t: "Questions" },
  { q: "________ is Mount Everest?", a: "How high", o: ["How tall", "How high", "How long"], t: "Questions" },
  { q: "________ is your grandmother? - She is 80.", a: "How old", o: ["How many", "How old", "How long"], t: "Questions" },

  // --- TOPIC: QUESTION TRANSFORMATIONS ---
  { q: "How old are you? -> What is your ________?", a: "age", o: ["old", "age", "birth"], t: "Transformations" },
  { q: "What is the age of this building? -> How ________ is this building?", a: "old", o: ["long", "old", "age"], t: "Transformations" },
  { q: "How far is it from A to B? -> What is the ________ between A and B?", a: "distance", o: ["length", "distance", "far"], t: "Transformations" },
  { q: "What is the distance between Hanoi and Hue? -> How ________ is it from Hanoi to Hue?", a: "far", o: ["long", "far", "distance"], t: "Transformations" },
  { q: "How long is the river? -> What is the ________ of the river?", a: "length", o: ["long", "length", "distance"], t: "Transformations" },
  { q: "What is the length of the table? -> How ________ is the table?", a: "long", o: ["far", "long", "tall"], t: "Transformations" },
  { q: "How high is the wall? -> What is the ________ of the wall?", a: "height", o: ["high", "height", "length"], t: "Transformations" },
  { q: "What is the height of the mountain? -> How ________ is the mountain?", a: "high", o: ["tall", "high", "height"], t: "Transformations" },
  { q: "How tall is he? -> What is his ________?", a: "height", o: ["tall", "height", "length"], t: "Transformations" },

  // --- EXTRA ---
  { q: "A child who is amazingly talented at something is called a ________.", a: "prodigy", o: ["prodigy", "student", "beginner"], t: "Vocabulary" },

  { q: "To ________ means to keep something in your mind.", a: "memorize", o: ["decide", "memorize", "arrive"], t: "Vocabulary" },

  // --- TOPIC: MEDALS & SPORTS ---
  { q: "He won a ________ medal in the 100m race.", a: "gold", o: ["gold", "silver", "bronze"], t: "Vocabulary" },
  { q: "She came second, so she got a ________ medal.", a: "silver", o: ["gold", "silver", "bronze"], t: "Vocabulary" },
  { q: "Third place receives a ________ medal.", a: "bronze", o: ["gold", "silver", "bronze"], t: "Vocabulary" },
  { q: "A person who wins a medal is called a ________.", a: "medalist", o: ["medal", "medalist", "medaling"], t: "Vocabulary" },
  { q: "Winning a medal is a great sporting ________.", a: "achievement", o: ["achievement", "achieve", "achieving"], t: "Vocabulary" },
  { q: "He trained hard to ________ his dream of becoming a champion.", a: "achieve", o: ["achieve", "achievement", "achiever"], t: "Vocabulary" },
  { q: "The athlete was proud of his ________ at the Olympics.", a: "success", o: ["success", "successful", "succeed"], t: "Vocabulary" },
  { q: "She worked hard and became very ________.", a: "successful", o: ["success", "successful", "succeed"], t: "Vocabulary" },
  { q: "If you practise every day, you will ________.", a: "succeed", o: ["success", "successful", "succeed"], t: "Vocabulary" },

  // --- TOPIC: BODYBUILDING & DIET ---
  { q: "You should practise ________ regularly and have a good diet.", a: "bodybuilding", o: ["bodybuilding", "bodybuilder", "build body"], t: "Vocabulary" },
  { q: "A person who does bodybuilding is a ________.", a: "bodybuilder", o: ["bodybuilding", "bodybuilder", "bodybuild"], t: "Vocabulary" },
  { q: "Eggs contain a lot of ________.", a: "nutrition", o: ["nutrition", "nutrient", "nutritious"], t: "Vocabulary" },
  { q: "Bananas contain helpful ________ that give us energy.", a: "nutrients", o: ["nutrients", "nutrition", "nutritions"], t: "Vocabulary" },
  { q: "A healthy diet can help you build ________.", a: "muscle", o: ["muscle", "mussel", "music"], t: "Vocabulary" },
  { q: "Eating too much sugar can ________ your health.", a: "reduce", o: ["reduce", "reduction", "reduced"], t: "Vocabulary" },
  { q: "Doing sports can lead to a ________ in stress.", a: "reduction", o: ["reduce", "reduction", "reducing"], t: "Vocabulary" },
  { q: "On ________, students need 8 hours of sleep.", a: "average", o: ["average", "usually", "total"], t: "Vocabulary" },
  { q: "This drink ________ a lot of vitamin C.", a: "contains", o: ["contains", "contain", "containing"], t: "Vocabulary" },
  { q: "You should ________ the instructions carefully.", a: "follow", o: ["follow", "finish", "force"], t: "Vocabulary" },
  { q: "You should eat ________ eggs, not too many.", a: "soft-boiled", o: ["soft-boiled", "hard-boiled", "scrambled"], t: "Vocabulary" },
  { q: "I like ________ eggs with bread for breakfast.", a: "scrambled", o: ["scrambled", "soft-boiled", "hard-boiled"], t: "Vocabulary" },
  { q: "My father prefers ________ eggs.", a: "hard-boiled", o: ["scrambled", "soft-boiled", "hard-boiled"], t: "Vocabulary" },
  { q: "Basketball players need between 2,500 and 5,000 ________ a day.", a: "calories", o: ["calories", "kilometres", "seconds"], t: "Vocabulary" },
  { q: "You should exercise ________, not only once a month.", a: "regularly", o: ["regularly", "regular", "irregular"], t: "Adj_Adv" },
  { q: "He goes to the gym ________.", a: "regularly", o: ["regular", "regularly", "regularity"], t: "Adj_Adv" },
  { q: "He has an ________ schedule, so he often skips workouts.", a: "irregular", o: ["irregular", "regular", "regularly"], t: "Vocabulary" },
  { q: "You should eat vegetables, ________ green ones.", a: "especially", o: ["especially", "special", "specially"], t: "Vocabulary" },

  // --- TOPIC: UNITS OF MEASUREMENT ---
  { q: "There are 7 days in a ________.", a: "week", o: ["week", "month", "year"], t: "Units" },
  { q: "There are 12 months in a ________.", a: "year", o: ["year", "week", "hour"], t: "Units" },
  { q: "There are 60 seconds in a ________.", a: "minute", o: ["minute", "hour", "day"], t: "Units" },
  { q: "There are 60 minutes in an ________.", a: "hour", o: ["hour", "day", "second"], t: "Units" },
  { q: "There are 24 hours in a ________.", a: "day", o: ["day", "month", "decade"], t: "Units" },
  { q: "A ________ is 10 years.", a: "decade", o: ["decade", "century", "millennium"], t: "Units" },
  { q: "A ________ is 100 years.", a: "century", o: ["century", "decade", "millennium"], t: "Units" },
  { q: "A ________ is 1,000 years.", a: "millennium", o: ["millennium", "century", "decade"], t: "Units" },
  { q: "A thousand is written as ________.", a: "1,000", o: ["100", "1,000", "10,000"], t: "Units" },
  { q: "A million is written as ________.", a: "1,000,000", o: ["1,000", "100,000", "1,000,000"], t: "Units" },
  { q: "A quarter means ________ of something.", a: "one fourth", o: ["one half", "one fourth", "one third"], t: "Units" },
  { q: "Half means ________.", a: "one second", o: ["one second", "one third", "one fifth"], t: "Units" },
  { q: "1 kilometre is 1,000 ________.", a: "metres", o: ["metres", "kilos", "tons"], t: "Units" },
  { q: "A kilo is short for ________.", a: "kilogram", o: ["kilogram", "kilometre", "kilo-second"], t: "Units" },
  { q: "A ton is a unit of ________.", a: "weight", o: ["time", "weight", "distance"], t: "Units" },
  { q: "We measure distance in metres and ________.", a: "kilometres", o: ["kilometres", "minutes", "tons"], t: "Units" },
  { q: "We measure time in seconds, minutes and ________.", a: "hours", o: ["hours", "kilos", "metres"], t: "Units" },

  // --- TOPIC: KEY PHRASES (GUESSING MEANING) ---
  { q: "If you don't know, say: 'I've ________ idea.'", a: "no", o: ["no", "any", "some"], t: "Phrases" },
  { q: "To ask someone to guess, you can say: 'Have a ________!'", a: "guess", o: ["guess", "look", "think"], t: "Phrases" },
  { q: "To ask for suggestions: 'Any ________?'", a: "ideas", o: ["ideas", "answers", "questions"], t: "Phrases" },
  { q: "To give an opinion: 'I ________ it's true.'", a: "reckon", o: ["reckon", "kick", "hold"], t: "Phrases" },
  { q: "To say something is not exact: '________ 10 minutes.'", a: "Around", o: ["Around", "Exactly", "Never"], t: "Phrases" },
  { q: "Another word for 'around' is ________.", a: "about", o: ["about", "behind", "below"], t: "Phrases" },
  { q: "To say you're not sure: 'Probably / ________.'", a: "maybe", o: ["maybe", "always", "certainly"], t: "Phrases" },

  // --- TOPIC: POSITIONS & PREPOSITIONS ---
  { q: "The ball is in the ________ of the box.", a: "middle", o: ["middle", "front", "behind"], t: "Positions" },
  { q: "The teacher is in ________ of the class.", a: "front", o: ["front", "behind", "middle"], t: "Positions" },
  { q: "The cat is ________ the chair.", a: "behind", o: ["behind", "in front of", "in the middle"], t: "Positions" },
  { q: "The car is on the ________ of the road.", a: "left", o: ["left", "middle", "top"], t: "Positions" },
  { q: "The shop is on the ________ of the street.", a: "right", o: ["right", "behind", "bottom"], t: "Positions" },
  { q: "The sun is at the ________ of the sky.", a: "top", o: ["top", "bottom", "middle"], t: "Positions" },
  { q: "The shoes are at the ________ of the bed.", a: "bottom", o: ["bottom", "top", "front"], t: "Positions" },
  { q: "In the ________, we can see mountains far away.", a: "background", o: ["background", "foreground", "middle"], t: "Positions" },
  { q: "In the ________, we can see a boy holding a balloon.", a: "foreground", o: ["foreground", "background", "behind"], t: "Positions" },

  // --- TOPIC: ACTION VERBS ---
  { q: "Don't ________ the ball into the window!", a: "kick", o: ["kick", "pick up", "hang from"], t: "Actions" },
  { q: "Please ________ your books from the floor.", a: "pick up", o: ["pick up", "kick", "hang from"], t: "Actions" },
  { q: "He tried to ________ his breath under water.", a: "hold", o: ["hold", "kick", "pick up"], t: "Actions" },
  { q: "The monkey can ________ the tree branch.", a: "hang from", o: ["hang from", "pick up", "kick"], t: "Actions" },

  // --- TOPIC: LINKING WORDS ---
  { q: "________ you go to bed, brush your teeth.", a: "Before", o: ["Before", "After", "While"], t: "Linking" },
  { q: "________ dinner, we watched a movie.", a: "After", o: ["After", "Before", "When"], t: "Linking" },
  { q: "Call me ________ you arrive home.", a: "when", o: ["when", "while", "before"], t: "Linking" },
  { q: "Don't talk ________ the teacher is speaking.", a: "while", o: ["while", "after", "as soon as"], t: "Linking" },
  { q: "________ I finish my homework, I will play games.", a: "As soon as", o: ["As soon as", "Although", "Before"], t: "Linking" },

  // --- TOPIC: GRAMMAR (ALTHOUGH / SEEM TO / HAPPEN TO) ---
  { q: "________ it rains, the night market is still crowded.", a: "Although", o: ["Although", "Because", "So"], t: "Grammar" },
  { q: "He ________ be tired today. He is very quiet.", a: "seems to", o: ["seems to", "happens to", "kicks"], t: "Grammar" },
  { q: "I happened to ________ my old teacher at the mall.", a: "see", o: ["see", "seeing", "seen"], t: "Grammar" },
  { q: "Happen to see means ________ see.", a: "accidentally", o: ["accidentally", "carefully", "regularly"], t: "Vocabulary" },

  // --- TOPIC: EXCLAMATIONS (WHAT / HOW) ---
  { q: "________ a clever girl!", a: "What", o: ["What", "How", "Which"], t: "Grammar" },
  { q: "________ clever the girl is!", a: "How", o: ["How", "What", "Where"], t: "Grammar" },
  { q: "________ a beautiful day!", a: "What", o: ["What", "How", "When"], t: "Grammar" },
  { q: "________ beautiful the flowers are!", a: "How", o: ["How", "What", "Who"], t: "Grammar" },

  // --- TOPIC: ADJECTIVES vs ADVERBS ---
  { q: "She is very ________ when she does homework.", a: "careful", o: ["careful", "carefully", "care"], t: "Adj_Adv" },
  { q: "She does her homework ________.", a: "carefully", o: ["careful", "carefully", "care"], t: "Adj_Adv" },
  { q: "He is a ________ person. He never gets angry.", a: "patient", o: ["patient", "patiently", "patience"], t: "Adj_Adv" },
  { q: "He waited ________ for the bus.", a: "patiently", o: ["patient", "patiently", "patience"], t: "Adj_Adv" },

  // --- TOPIC: COMPARATIVES ---
  { q: "Gold is ________ than silver in value.", a: "more expensive", o: ["more expensive", "the most expensive", "as expensive"], t: "Comparative" },
  { q: "This athlete is ________ than the others.", a: "stronger", o: ["stronger", "strongest", "as strong"], t: "Comparative" },
  { q: "A cheetah is ________ than a dog.", a: "faster", o: ["faster", "fastest", "as fast"], t: "Comparative" },
  { q: "My bag is ________ than yours.", a: "heavier", o: ["heavier", "heaviest", "as heavy"], t: "Comparative" },
  { q: "This test is ________ than the last one.", a: "easier", o: ["easier", "easiest", "as easy"], t: "Comparative" },
  { q: "She runs ________ than her brother.", a: "more quickly", o: ["more quickly", "quickest", "as quickly"], t: "Comparative" },

  // --- TOPIC: SUPERLATIVES ---
  { q: "He is the ________ student in our class.", a: "smartest", o: ["smartest", "smarter", "as smart"], t: "Superlative" },
  { q: "This is the ________ building in the city.", a: "tallest", o: ["tallest", "taller", "as tall"], t: "Superlative" },
  { q: "She is the ________ athlete in the team.", a: "most careful", o: ["most careful", "carefuler", "more carefully"], t: "Superlative" },
  { q: "That was the ________ match of the year!", a: "most exciting", o: ["most exciting", "more exciting", "excitingest"], t: "Superlative" },

  // --- TOPIC: EQUAL COMPARISON ---
  { q: "My phone is ________ expensive as yours.", a: "as", o: ["as", "more", "most"], t: "Equal" },
  { q: "She sings as ________ as her sister.", a: "beautifully", o: ["beautiful", "beautifully", "beauty"], t: "Equal" },
  { q: "This exercise is not as ________ as the last one.", a: "difficult", o: ["difficult", "difficultly", "difficulty"], t: "Equal" },

  // --- TOPIC: LIKE / LOOK LIKE / SIMILAR TO ---
  { q: "He looks ________ his father. They have the same face.", a: "like", o: ["like", "as soon as", "although"], t: "Phrases" },
  { q: "This picture looks ________ a real photo!", a: "like", o: ["like", "behind", "while"], t: "Phrases" },
  { q: "My bag is similar ________ yours.", a: "to", o: ["to", "with", "from"], t: "Phrases" },

  // --- TOPIC: MEASUREMENT QUESTIONS ---
  { q: "________ is it from your house to school?", a: "How far", o: ["How far", "How long", "How old"], t: "Questions" },
  { q: "________ does the trip take? - Two hours.", a: "How long", o: ["How long", "How far", "How much"], t: "Questions" },
  { q: "________ is Mount Everest?", a: "How high", o: ["How high", "How tall", "How long"], t: "Questions" },
  { q: "________ is your brother? - He is 1.75m.", a: "How tall", o: ["How tall", "How old", "How far"], t: "Questions" },
  { q: "________ does this cost?", a: "How much", o: ["How much", "How many", "How often"], t: "Questions" },
  { q: "________ eggs do you eat every week?", a: "How many", o: ["How many", "How much", "How long"], t: "Questions" },

  // --- TOPIC: WORD FORMS ---
  { q: "Decoration is a ________.", a: "noun", o: ["noun", "verb", "adverb"], t: "WordForm" },
  { q: "Start up is often used as a ________.", a: "noun", o: ["noun", "adjective", "preposition"], t: "WordForm" },
  { q: "The word 'decorate' is a ________.", a: "verb", o: ["verb", "noun", "adjective"], t: "WordForm" },

  // --- EXTRA MIXED REVIEW (FILL IN BLANKS) ---
  { q: "A ________ market is usually crowded at night.", a: "night", o: ["night", "ton", "kilo"], t: "Vocabulary" },
  { q: "We need a good ________ to stay healthy.", a: "diet", o: ["diet", "decade", "century"], t: "Vocabulary" },
  { q: "If you eat healthy food, you will feel full of ________.", a: "energy", o: ["energy", "medal", "metre"], t: "Vocabulary" },
  { q: "He practises every day, so he will ________ his goal.", a: "achieve", o: ["achieve", "arrive", "average"], t: "Vocabulary" },
  { q: "The athlete is holding a ________ medal.", a: "gold", o: ["gold", "quarter", "second"], t: "Vocabulary" },
  { q: "He lifted 1 ________ of weight in the competition.", a: "ton", o: ["ton", "metre", "minute"], t: "Units" },
  { q: "A ________ is 1/4 of an hour (15 minutes).", a: "quarter", o: ["quarter", "half", "decade"], t: "Units" },
  { q: "The boy is standing in ________ of the door.", a: "front", o: ["front", "middle", "bottom"], t: "Positions" },
  { q: "The picture in the ________ is clearer than the background.", a: "foreground", o: ["foreground", "background", "behind"], t: "Positions" },
  { q: "He picked up the bag ________ and left quietly.", a: "carefully", o: ["carefully", "careful", "care"], t: "Adj_Adv" },

  // 100th question
  { q: "If you don't know the meaning of a word, you can guess it from the ________.", a: "context", o: ["context", "medal", "ton"], t: "Reading" }
];


  const englishGame = {
    curr: null,
    lastIndex: -1,
    isProcessing: false,
    start() {
      document.getElementById('game-overlay').style.display = 'flex';
      document.getElementById('game-label').innerText = "ENGLISH COMMAND";
      galaxy.renderGameScoreboard();
      this.generate();
    },
    generate() {
      this.isProcessing = false;
      galaxy.applyTransition();
      if (ENGLISH_BANK.length === 0) return;

      let idx = Math.floor(Math.random() * ENGLISH_BANK.length);
      let attempts = 0;
      while (idx === this.lastIndex && attempts < 10) {
        idx = Math.floor(Math.random() * ENGLISH_BANK.length);
        attempts++;
      }
      this.lastIndex = idx;
      this.curr = ENGLISH_BANK[idx];

      document.getElementById('q-text').innerText = this.curr.q;
      document.getElementById('q-tag').innerText = this.curr.t + " ‚Ä¢ HK2";

      const shuffled = [...this.curr.o].sort(() => Math.random() - 0.5);
      document.getElementById('q-action').innerHTML = `
        <div class="option-list">
          ${shuffled.map(o => `<button class="option-item" onclick="englishGame.check(this, '${o.replace(/'/g,"\\'")}')">${o}</button>`).join('')}
        </div>
        <div style="width:100%; display:flex; justify-content:center; margin-top:10px;">
          <button class="btn-confirm small" style="background:#555;" onclick="englishGame.skip()">B·ªé QUA</button>
        </div>
      `;
    },
    check(btn, choice) {
      if (this.isProcessing) return;
      this.isProcessing = true;

      const allBtns = document.querySelectorAll('.option-item');
      allBtns.forEach(b => b.disabled = true);

      if (choice === this.curr.a) {
        galaxy.showGameToast("ƒê√öNG R·ªíI! +10 XP", "success");
        galaxy.addPoints(10);
        setTimeout(() => this.generate(), 800);
      } else {
        galaxy.showGameToast(`SAI! ƒê√ÅP √ÅN: ${this.curr.a}`, "error");
        setTimeout(() => this.generate(), 2000);
      }
    },
    skip() {
      if (this.isProcessing) return;
      this.isProcessing = true;
      galaxy.showGameToast("ƒê√É B·ªé QUA", "info");
      setTimeout(() => { this.isProcessing = false; this.generate(); }, 600);
    }
  };

  window.galaxy = galaxy;
  window.englishGame = englishGame;
  window.mathGame = mathGame;
  window.adminAdjust = adminAdjust;

  window.adminApplyInput = adminApplyInput;
  window.adminResetScores = adminResetScores;
  window.adminUndo = adminUndo;

  window.onload = () => galaxy.init();
</script>
</body>
</html>

